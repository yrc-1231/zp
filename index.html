<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŸ³ç«ç”µç«ç™¾æ—¥åº†å…¸å¤§è½¬ç›˜</title>
    <style>
        /* ================= 1. æ ¸å¿ƒå¸ƒå±€ä¸èƒŒæ™¯ ================= */
        body {
            background-color: #1a0505;
            font-family: 'Microsoft YaHei', 'Arial Black', sans-serif;
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px 0;
            color: #fff;
            overflow-x: hidden;
        }

        /* åŠ¨æ€å…‰èŠ’èƒŒæ™¯ */
        .sunburst {
            position: fixed; top: 50%; left: 50%;
            width: 200vmax; height: 200vmax;
            transform: translate(-50%, -50%);
            background: repeating-conic-gradient(from 0deg, rgba(255, 0, 0, 0.05) 0deg, rgba(255, 0, 0, 0.05) 15deg, transparent 15deg, transparent 30deg);
            animation: rotateBurst 60s linear infinite;
            z-index: 0; pointer-events: none;
        }
        @keyframes rotateBurst { to { transform: translate(-50%, -50%) rotate(360deg); } }

        /* å½©å¸¦å±‚ */
        #confetti-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
        .confetti { position: absolute; width: 10px; height: 10px; background-color: #ffd700; animation: fall linear infinite; }
        @keyframes fall { to { transform: translateY(100vh) rotate(720deg); } }

        /* ================= 2. æ ‡é¢˜ ================= */
        .header-box { z-index: 10; text-align: center; margin-bottom: 20px; position: relative; }
        .main-title {
            font-size: 56px; margin: 0; font-weight: 900; font-style: italic; color: #fff;
            text-shadow: 0 0 10px #ff0033, 0 0 20px #ff0033, 0 0 40px #ffcc00;
            letter-spacing: 2px; transform: skewX(-10deg);
        }
        .badge {
            display: inline-block; background: linear-gradient(to right, #ffcc00, #ff8800);
            color: #330000; padding: 5px 20px; font-size: 18px; font-weight: bold;
            border-radius: 50px; box-shadow: 0 0 15px rgba(255, 200, 0, 0.8);
            margin-top: 10px; transform: skewX(-10deg);
        }

        /* ================= 3. è½¬ç›˜ä¸»ä½“ ================= */
        .wheel-wrapper {
            position: relative; width: 500px; height: 500px; z-index: 10;
            display: flex; justify-content: center; align-items: center;
            filter: drop-shadow(0 0 30px rgba(255, 50, 50, 0.6));
            margin: 20px 0 40px 0;
        }
        #wheelCanvas { border-radius: 50%; transition: transform 4s cubic-bezier(0.1, 0.7, 0.1, 1); }
        .pointer {
            position: absolute; top: -15px; left: 50%; transform: translateX(-50%); z-index: 20;
            width: 50px; height: 70px; background: linear-gradient(to bottom, #ffff00, #ff8800);
            clip-path: polygon(50% 100%, 0 0, 100% 0); filter: drop-shadow(0 4px 4px rgba(0,0,0,0.5));
        }

        /* ================= 4. æŒ‰é’® ================= */
        .btn-spin {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 100px; height: 100px; border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #ff4d4d, #cc0000, #800000);
            border: 4px solid #ffcc00; color: #fff; font-size: 24px; font-weight: 900;
            cursor: pointer; box-shadow: 0 0 20px rgba(255, 0, 0, 0.6); z-index: 30;
            outline: none; animation: pulse 1.2s infinite; text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 20px rgba(255, 0, 0, 0.6); }
            50% { transform: translate(-50%, -50%) scale(1.1); box-shadow: 0 0 40px rgba(255, 0, 0, 0.9); }
            100% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 20px rgba(255, 0, 0, 0.6); }
        }
        .btn-spin:disabled { background: #333; border-color: #555; color: #888; animation: none; cursor: not-allowed; }

        /* ================= 5. è§„åˆ™é¢æ¿ ================= */
        .info-panel {
            position: relative; z-index: 10; width: 90%; max-width: 600px;
            background: rgba(50, 0, 0, 0.9); border: 2px solid #ffaa00; border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }
        .panel-header { background: linear-gradient(to right, #cc0000, #880000); padding: 15px; text-align: center; border-bottom: 2px solid #ffaa00; border-radius: 8px 8px 0 0; }
        .panel-title { color: #ffcc00; font-size: 18px; font-weight: bold; }
        .panel-content { padding: 20px; font-size: 14px; line-height: 1.6; }
        .prize-list li { padding: 8px 0; border-bottom: 1px dashed #663333; display: flex; align-items: center; }
        .num-tag { background: #ffaa00; color: #000; font-weight: bold; padding: 2px 6px; border-radius: 4px; margin-right: 10px; font-size: 12px; }
        .highlight { color: #ffaa00; font-weight: bold; }

        /* ================= 6. åº•éƒ¨æ˜¾çœ¼å“ç‰Œå¡ç‰‡ ================= */
        .brand-card {
            position: relative; z-index: 10; width: 90%; max-width: 600px;
            margin-top: 25px; margin-bottom: 50px;
            background: linear-gradient(135deg, #500000 0%, #1a0000 100%);
            border: 2px solid #ffcc00; border-radius: 15px; padding: 25px; text-align: center;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.3); animation: borderGlow 3s infinite alternate;
        }
        @keyframes borderGlow { from { box-shadow: 0 0 10px rgba(255, 204, 0, 0.2); } to { box-shadow: 0 0 25px rgba(255, 204, 0, 0.6); } }
        .brand-row { margin-bottom: 12px; font-size: 16px; color: #e0e0e0; display: flex; justify-content: center; align-items: center; gap: 10px; }
        .brand-label { opacity: 0.8; }
        .brand-value { color: #ffcc00; font-weight: 900; font-size: 20px; font-family: 'Arial Black', sans-serif; letter-spacing: 1px; text-shadow: 0 2px 2px rgba(0,0,0,0.5); }
        .big-jump-btn {
            display: block; width: 80%; margin: 20px auto 0 auto; padding: 12px 0;
            background: linear-gradient(to bottom, #ffcc00, #ff8800); color: #4a0000;
            font-size: 18px; font-weight: bold; text-decoration: none; border-radius: 50px;
            box-shadow: 0 5px 15px rgba(255, 136, 0, 0.4); transition: transform 0.1s;
        }
        .big-jump-btn:active { transform: scale(0.96); }

        /* ================= 7. å¼¹çª— ================= */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8);
            z-index: 9999; display: none; justify-content: center; align-items: center; backdrop-filter: blur(4px);
        }
        .modal-box {
            background: linear-gradient(135deg, #440000 0%, #111 100%); width: 80%; max-width: 350px; padding: 30px;
            border: 3px solid #ffcc00; border-radius: 15px; text-align: center; box-shadow: 0 0 60px rgba(255, 170, 0, 0.4);
            animation: popIn 0.3s ease-out;
        }
        @keyframes popIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .modal-title { color: #ffcc00; font-size: 24px; margin-bottom: 15px; font-weight: 900; }
        .modal-text { color: #fff; font-size: 16px; margin-bottom: 25px; white-space: pre-wrap; }
        .modal-btn {
            background: linear-gradient(to bottom, #ffcc00, #ff9900); border: none; color: #000; padding: 10px 30px;
            font-size: 16px; font-weight: bold; border-radius: 30px; cursor: pointer;
        }
    </style>
</head>
<body>

    <div class="sunburst"></div>
    <div id="confetti-container"></div>

    <div class="header-box">
        <div class="main-title">çŸ³ç«ç”µç«ç™¾æ—¥åº†å…¸å¤§è½¬ç›˜</div>
        <div class="badge"> âœ¨ æ´»åŠ¨æ—¶é—´:2025.12.2 00:00-2025.12.8 23:59 âœ¨</div>
    </div>

    <!-- è½¬ç›˜åŒºåŸŸ -->
    <div class="wheel-wrapper">
        <div class="pointer"></div>
        <canvas id="wheelCanvas" width="500" height="500"></canvas>
        <button class="btn-spin" id="spinBtn" onclick="startSpin()">æŠ½å¥–</button>
    </div>

    <!-- è§„åˆ™é¢æ¿ -->
    <div class="info-panel">
        <div class="panel-header">
            <div class="panel-title">ğŸ† åº†å…¸å¥–åŠ±æ¸…å• ğŸ†</div>
        </div>
        <div class="panel-content">
            <ul class="prize-list" style="list-style: none; padding: 0; margin: 0 0 20px 0;">
                <li><span class="num-tag">01</span> å¨±ä¹å¥³é™ª/ç”·é™ª æœºå¯†ä¸€å°æ—¶é™ªç©</li>
                <li><span class="num-tag">02</span> 9 æŠ˜ä¼˜æƒ åˆ¸ä¸€å¼ </li>
                <li><span class="num-tag">03</span> 50 å…ƒé‡‘é¢é¢„å­˜</li>
                <li><span class="num-tag">04</span> 128 é‡‘é¢æœºå¯†ä½“éªŒå•ä¸€å•</li>
                <li><span class="num-tag">05</span> 1000w å“ˆå¤«å¸ (è·‘åˆ€)</li>
                <li><span class="num-tag">06</span> 400w æŠ¤èˆªä¿åº•å·</li>
            </ul>
            <div style="color: #ffcc00; margin-bottom: 5px; font-weight: bold;">âš ï¸ è§„åˆ™è¯´æ˜ï¼š</div>
            <div style="color: #ddd; font-size: 13px; text-align: justify; text-justify: inter-ideograph; line-height: 1.6;">
                ä»¥ä¸Šæ‰€èµ é€ä¼˜æƒ å·ä»¥åŠæ´»åŠ¨æœ¬èº«ä¼˜æƒ <span style="color:#ff5555">æ— æ³•å åŠ ä½¿ç”¨</span>ï¼Œä¾‹å¦‚é™ªç©å•4å°æ—¶ç«‹å‡ä¼˜æƒ åæ— æ³•å†è¿›è¡Œæ‰“æŠ˜ï¼Œä¸‹å•å‰è¯·å°å®é€‰æ‹©æ‚¨çš„ä¼˜æƒ æ–¹æ¡ˆã€‚ä»¥åŠæœ¬æ¬¡æ´»åŠ¨ä¸­æ‰€æœ‰èµ é€å¥–åŠ±éœ€<span class="highlight">åœ¨æ´»åŠ¨ä¸­å®Œæˆ</span>ï¼Œæ´»åŠ¨åˆ°æœŸåæ— æ³•å†ä½¿ç”¨æ´»åŠ¨ä¸­çš„å¥–åŠ±ï¼
            </div>
        </div>
    </div>

    <!-- åº•éƒ¨æ˜¾çœ¼å“ç‰Œå¡ç‰‡ -->
    <div class="brand-card">
        <div class="brand-row">
            <span class="brand-label">ğŸ§ KOOK è¯­éŸ³:</span>
            <span class="brand-value">6480</span>
        </div>
        <div class="brand-row">
            <span class="brand-label">ğŸ“± å¾®ä¿¡æœåŠ¡å·/å°ç¨‹åº:</span>
            <span class="brand-value">çŸ³ç«ç”µç«</span>
        </div>
        <!-- ğŸ‘‡ è®°å¾—æŠŠ href æ¢æˆä½ çš„å°ç¨‹åºé“¾æ¥ -->
        <a href="https://taix.cn/plugins/mobile/h5/mall/5489/?#/pages/index/index" class="big-jump-btn">
            ğŸš€ ç‚¹å‡»è¿›å…¥å°ç¨‹åºä¸‹å•
        </a>
    </div>

    <!-- å¼¹çª— -->
    <div class="modal-overlay" id="resultModal">
        <div class="modal-box">
            <div class="modal-title">ğŸ‰ æ­å–œä¸­å¥– ğŸ‰</div>
            <div class="modal-text" id="modalContent">...</div>
            <button class="modal-btn" onclick="closeModal()">æ”¶ä¸‹å¥–åŠ±</button>
        </div>
    </div>

      <script>
        // ================= 1. å¥–å“é…ç½® =================
        const prizes = [
            { 
                text: "æœºå¯†é™ªç©", 
                fullText: "å¨±ä¹å¥³é™ª/ç”·é™ª æœºå¯†ä¸€å°æ—¶é™ªç©",
                weight: 15, 
                bgColor: "#cc0000", textColor: "#fff",
                imgSrc: "è½¬ç›˜å¥–æ± å°å›¾æ ‡/å¨±ä¹å¥³é™ªç”·é™ª.jpg" 
            },
            { 
                text: "9æŠ˜ç¥åˆ¸", 
                fullText: "9 æŠ˜ä¼˜æƒ åˆ¸ä¸€å¼ ",
                weight: 25, 
                bgColor: "#ffffff", textColor: "#cc0000",
                imgSrc: "è½¬ç›˜å¥–æ± å°å›¾æ ‡/9æŠ˜ä¼˜æƒ åˆ¸ä¸€å¼ .jpg"
            },
            { 
                text: "50å…ƒé¢„å­˜", 
                fullText: "50 å…ƒé‡‘é¢é¢„å­˜",
                weight: 15, 
                bgColor: "#ffaa00", textColor: "#000",
                imgSrc: "è½¬ç›˜å¥–æ± å°å›¾æ ‡/50å…ƒé‡‘é¢.jpg"
            },
            { 
                text: "128ä½“éªŒ", 
                fullText: "128 é‡‘é¢æœºå¯†ä½“éªŒå•ä¸€å•",
                weight: 10, 
                bgColor: "#222222", textColor: "#ffaa00",
                imgSrc: "è½¬ç›˜å¥–æ± å°å›¾æ ‡/128é‡‘é¢.jpg"
            },
            { 
                text: "1000Wå¸", 
                fullText: "1000w å“ˆå¤«å¸(è·‘åˆ€)",
                weight: 10, 
                bgColor: "#ffcc00", textColor: "#000",
                imgSrc: "è½¬ç›˜å¥–æ± å°å›¾æ ‡/1000wå“ˆå¤«å¸.jpg"
            },
            { 
                text: "400Wä¿åº•", 
                fullText: "400w æŠ¤èˆªä¿åº•å·",
                weight: 25, 
                bgColor: "#000000", textColor: "#00ffff",
                imgSrc: "è½¬ç›˜å¥–æ± å°å›¾æ ‡/400wæŠ¤èˆªä¿åº•å·.jpg"
            }
        ];

        // ================= 2. æ ¸å¿ƒå˜é‡ä¸ç»˜åˆ¶ =================
        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spinBtn');
        
        const numSegments = prizes.length;
        const anglePerSegment = (2 * Math.PI) / numSegments; // æ¯ä¸ªæ‰‡å½¢çš„å¼§åº¦
        const centerX = 250; 
        const centerY = 250; 
        const radius = 230; 

        let currentRotation = 0; // å½“å‰æ—‹è½¬è§’åº¦ï¼ˆç´¯åŠ ï¼‰
        let isSpinning = false;

        // å›¾ç‰‡åŠ è½½é€»è¾‘
        function preloadImages() {
            let loaded = 0;
            let total = prizes.length;
            prizes.forEach((prize) => {
                if (prize.imgSrc) {
                    const img = new Image();
                    img.onload = () => { loaded++; if (loaded === total) drawWheel(); };
                    img.onerror = () => { loaded++; if (loaded === total) drawWheel(); };
                    img.src = prize.imgSrc;
                    prize.imgObj = img; 
                } else {
                    loaded++;
                    if (loaded === total) drawWheel();
                }
            });
        }

        // ç»˜åˆ¶è½¬ç›˜
        function drawWheel() {
            ctx.clearRect(0, 0, 500, 500);

            // å¤–æ¡†
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius + 15, 0, 2 * Math.PI);
            ctx.fillStyle = "#550000"; ctx.fill();
            ctx.lineWidth = 6; ctx.strokeStyle = "#ffcc00"; ctx.stroke();

            for (let i = 0; i < numSegments; i++) {
                const angle = i * anglePerSegment;
                const p = prizes[i];
                
                // æ‰‡å½¢
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, angle, angle + anglePerSegment);
                ctx.fillStyle = p.bgColor; ctx.fill();
                ctx.strokeStyle = "#ffcc00"; ctx.lineWidth = 2; ctx.stroke();

                ctx.save();
                // æ—‹è½¬åˆ°æ‰‡å½¢ä¸­å¿ƒç»˜åˆ¶æ–‡å­—/å›¾æ ‡
                ctx.translate(centerX, centerY);
                ctx.rotate(angle + anglePerSegment / 2);

                // æ–‡å­—
                ctx.save(); 
                const text = p.text;
                ctx.font = "bold 22px Microsoft YaHei"; 
                ctx.fillStyle = p.textColor;
                ctx.textBaseline = "middle"; 
                ctx.textAlign = "center";
                const textRadius = radius - 25; 
                const anglePerChar = 0.12; 
                const totalArc = (text.length - 1) * anglePerChar;
                ctx.rotate(-totalArc / 2);
                for (let k = 0; k < text.length; k++) {
                    ctx.save();
                    ctx.translate(textRadius, 0);
                    ctx.rotate(Math.PI / 2); 
                    ctx.fillText(text[k], 0, 0);
                    ctx.restore();
                    ctx.rotate(anglePerChar);
                }
                ctx.restore();

                // å›¾ç‰‡/å›¾æ ‡
                const contentX = radius * 0.45; 
                if (p.imgObj && p.imgObj.complete) {
                    const imgSize = 50; 
                    const imgY = -imgSize / 2; 
                    ctx.drawImage(p.imgObj, contentX, imgY, imgSize, imgSize);
                } else {
                    ctx.textAlign = "center";
                    ctx.font = "30px Arial";
                    ctx.fillText("ğŸ", contentX + 20, 5);
                }
                ctx.restore();
            }

            // ç¯æ³¡
            const totalBulbs = 24;
            for(let j=0; j<totalBulbs; j++) {
                const theta = (j / totalBulbs) * 2 * Math.PI;
                const bx = centerX + Math.cos(theta) * (radius + 8);
                const by = centerY + Math.sin(theta) * (radius + 8);
                ctx.beginPath();
                ctx.arc(bx, by, 5, 0, 2 * Math.PI);
                ctx.fillStyle = (j % 2 === 0) ? "#ffff00" : "#ffffff";
                ctx.fill();
            }

            // ä¸­å¿ƒ
            ctx.beginPath();
            ctx.arc(centerX, centerY, 60, 0, 2 * Math.PI);
            ctx.fillStyle = "#330000"; ctx.fill();
            ctx.strokeStyle = "#ffcc00"; ctx.lineWidth = 3; ctx.stroke();
        }

        // ================= 3. æŠ½å¥–ä¸æ ¡å‡†æ ¸å¿ƒé€»è¾‘ =================
        
        // ğŸš¨ã€è°ƒè¯•å¼€å…³ã€‘ğŸš¨
        // å¦‚æœè®¾ä¸º trueï¼Œæ¯æ¬¡éƒ½ä¼šä¸­â€œç¬¬ä¸€ä¸ªå¥–å“â€ï¼ˆæœºå¯†é™ªç©ï¼‰ï¼Œä¸“é—¨ç”¨æ¥æ ¡å‡†ä½ç½®ã€‚
        // æ ¡å‡†å®Œè¯·ä¸€å®šæ”¹æˆ falseï¼
        const IS_DEBUG_MODE = false; 

        function getKeyResult() {
            if (IS_DEBUG_MODE) return 0; // è°ƒè¯•æ¨¡å¼ï¼šå¼ºåˆ¶è¿”å›ç¬¬0ä¸ª

            const totalWeight = prizes.reduce((sum, p) => sum + p.weight, 0);
            let random = Math.random() * totalWeight;
            for (let i = 0; i < prizes.length; i++) {
                random -= prizes[i].weight;
                if (random <= 0) return i;
            }
            return 0;
        }

        function startSpin() {
            if (isSpinning) return;
            isSpinning = true;
            spinBtn.disabled = true;
            
            const winningIndex = getKeyResult();
            const prize = prizes[winningIndex];

            // ğŸ¯ã€å…³é”®ä¿®å¤å…¬å¼ã€‘ğŸ¯
            // 1. (360 - winningIndex * 60) -> ç®—å‡ºç›®æ ‡å¥–å“ç›¸å¯¹äº0åº¦çš„åå‘è§’åº¦
            // 2. -120 -> è¿™æ˜¯é»„é‡‘ä¿®æ­£å€¼ (Canvas 0åº¦åœ¨3ç‚¹é’Ÿï¼ŒæŒ‡é’ˆåœ¨12ç‚¹é’Ÿï¼Œä¸”å¥–å“ä¸­å¿ƒåç§»30åº¦)
            //    è®¡ç®—é€»è¾‘ï¼š3ç‚¹é’Ÿ(0åº¦) -> 12ç‚¹é’Ÿ(-90åº¦) -> å†å‡å»åŠä¸ªæ‰‡å½¢(30åº¦) = -120åº¦
            const segmentDeg = 360 / numSegments; // 60åº¦
            const baseOffset = -120; // ğŸ‘ˆ è¿™é‡Œçš„ -120 æ˜¯å…³é”®ï¼
            
            // è®¡ç®—ç›®æ ‡è§’åº¦
            const targetAngle = (360 - (winningIndex * segmentDeg)) + baseOffset;
            
            // åŠ ä¸Šå¤šè½¬çš„åœˆæ•° (5åœˆ)
            const extraSpins = 5 * 360; 
            
            // è®¡ç®—æœ€ç»ˆæ—‹è½¬å€¼ (åŸºäºå½“å‰çš„ currentRotation ç´¯åŠ )
            // å¿…é¡»ä¿è¯æ¯æ¬¡éƒ½æ¯”ä¸Šä¸€æ¬¡çš„è§’åº¦å¤§ï¼Œè¿™æ ·æ‰ä¼šä¸€ç›´é¡ºæ—¶é’ˆè½¬
            let nextRotation = currentRotation + extraSpins + targetAngle;
            
            // è¿™é‡Œçš„ math å¤„ç†æ˜¯ä¸ºäº†å¤„ç†å¤šæ¬¡ç‚¹å‡»åçš„è§’åº¦è¡”æ¥ï¼Œè®©å®ƒè½¬å¾—æ›´è‡ªç„¶
            // æˆ‘ä»¬éœ€è¦ç®—å‡ºå½“å‰è§’åº¦é™¤ä»¥360çš„ä½™æ•°ï¼Œå†æ¥ä¸Šæ–°çš„è§’åº¦
            const currentMod = currentRotation % 360;
            // ä¿®æ­£ç´¯åŠ é€»è¾‘ï¼šè®©æ–°è§’åº¦ç­‰äº (å½“å‰æ•´åœˆ + æ–°åœˆ + ç›®æ ‡åç§»)
            // ç®€å•ç²—æš´æ³•ï¼šç›´æ¥è®¾ç½®æ–°çš„ transformï¼Œä¸ç”¨ç®¡ä¹‹å‰çš„ä½™æ•°ï¼Œåªè¦æ¯”å½“å‰å¤§å¾ˆå¤šå°±è¡Œ
            // é‡æ–°è®¡ç®—ï¼š
            let finalRotate = currentRotation + extraSpins;
            // è°ƒæ•´åˆ°ç›®æ ‡è§’åº¦çš„ä½™æ•°ä½ç½®
            const targetMod = targetAngle % 360; // æ¯”å¦‚ -120
            // è®© finalRotate çš„ä½™æ•°å˜æˆ targetMod
            const diff = targetMod - (finalRotate % 360);
            finalRotate += diff;
            
            // ä¿®æ­£æ­£è´Ÿå€¼é—®é¢˜ï¼Œç¡®ä¿æ˜¯æ­£å‘æ—‹è½¬
            if (finalRotate < currentRotation) {
                finalRotate += 360; 
            }

            canvas.style.transform = `rotate(${finalRotate}deg)`;
            currentRotation = finalRotate;

            setTimeout(() => {
                isSpinning = false;
                spinBtn.disabled = false;
                showModal(prize.fullText);
            }, 4000);
        }

        // ================= 4. è¾…åŠ©åŠŸèƒ½ =================
        const modal = document.getElementById('resultModal');
        const modalContent = document.getElementById('modalContent');
        function showModal(text) {
            modalContent.innerText = text;
            modal.style.display = 'flex';
        }
        function closeModal() {
            modal.style.display = 'none';
        }

        const confettiContainer = document.getElementById('confetti-container');
        const colors = ['#ffcc00', '#ff0033', '#ffffff', '#ff8800'];
        setInterval(() => {
            const el = document.createElement('div');
            el.classList.add('confetti');
            el.style.left = Math.random() * 100 + 'vw';
            el.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            el.style.animationDuration = (Math.random() * 3 + 2) + 's';
            confettiContainer.appendChild(el);
            setTimeout(() => el.remove(), 5000);
        }, 150);

        // å¯åŠ¨
        preloadImages();

    </script>

</body>
</html>
